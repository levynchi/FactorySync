# FactorySync - ממיר אקספורט של אופטיטקס לאקסל נקי

## תיאור הפרויקט
תוכנה מקצועית לניתוח קבצי אקספורט של אופטיטקס והמרתם לפורמט אקסל נקי עם אפשרות העלאה ישירה לאירטייבל וניהול טבלה מקומית.

## 🆕 מבנה חדש - גרסה 2.0
התוכנה עברה ל**מבנה מודולרי מקצועי** עם הפרדה ברורה בין המודולים השונים:

```
FactorySync/
├── main.py                    # קובץ הפעלה ראשי
├── src/                       # קוד המקור
│   ├── core/                  # מודולים עיקריים
│   │   ├── analyzer.py        # ניתוח קבצי אופטיטקס
│   │   ├── drawings_manager.py # ניהול טבלה מקומית
│   │   └── airtable_manager.py # ניהול Airtable
│   ├── gui/                   # ממשק משתמש
│   │   ├── main_window.py     # חלון ראשי
│   │   └── drawings_window.py # חלון מנהל ציורים
│   └── utils/                 # כלי עזר
│       └── config_manager.py  # ניהול הגדרות
├── config.json               # הגדרות
├── drawings_data.json        # נתוני טבלה מקומית
└── requirements.txt          # תלויות
```

## פיצ'רים עיקריים
- 🔍 **ניתוח קבצי Excel** מאופטיטקס
- 📊 **המרה לפורמט נקי** ומסודר
- 🔄 **טיפול אוטומטי** ב-Layout Tubular
- 📤 **העלאה ישירה** לאירטייבל
- 📋 **טבלה מקומית** - ניהול כל הציורים במחשב
- 📁 **מנהל ציורים** - צפייה, עריכה ומחיקה של רשומות
- ⚙️ **ממשק גרפי** ידידותי למשתמש
- 💾 **שמירת הגדרות** אוטומטית

## התקנה

### דרישות מערכת
- Python 3.8 ומעלה
- Windows/Mac/Linux

### הוראות התקנה

1. **שכפל את הפרויקט:**
```bash
git clone https://github.com/levynchi/FactorySync.git
cd FactorySync
```

2. **צור סביבה וירטואלית:**
```bash
python -m venv .venv
```

3. **הפעל את הסביבה הוירטואלית:**

**Windows:**
```bash
.venv\Scripts\activate
```

**Mac/Linux:**
```bash
source .venv/bin/activate
```

4. **התקן את הספריות הנדרשות:**
```bash
pip install -r requirements.txt
```

## שימוש

### הפעלת התוכנה
```bash
python main.py
```

### שלבי עבודה
1. **בחירת קבצים:**
   - בחר קובץ אקספורט של אופטיטקס
   - בחר קובץ מוצרים (אוטומטי אם קיים בתיקייה)

2. **ניתוח:**
   - לחץ על "נתח קבצים" לעיבוד הנתונים
   - בדוק תוצאות בחלון התוצאות

3. **שמירה והעלאה:**
   - **שמור כ-Excel** - ייצוא לקובץ מקומי
   - **העלה לאייר טייבל** - העלאה ישירה (דורש הגדרת API)
   - **הוסף לטבלה המקומית** - שמירה בטבלה מקומית
   - **מנהל ציורים** - פתיחת דף ניהול הטבלה המקומית

## המודולים החדשים

### 🔧 Core Modules (src/core/)

#### OptitexAnalyzer (analyzer.py)
- **ניתוח קבצי אופטיטקס** ויצירת טבלה נקייה
- **זיהוי אוטומטי** של Layout Tubular
- **מיון חכם** של מידות (מספרים, חודשים, טקסט)
- **סינון כמויות** לפי העדפות המשתמש

#### DrawingsManager (drawings_manager.py)
- **ניהול מלא** של הטבלה המקומית
- **שמירה וטעינה** אוטומטית ב-JSON
- **סטטיסטיקות** ונתונים מרוכזים
- **ייצוא לאקסל** של כל הנתונים

#### AirtableManager (airtable_manager.py)
- **חיבור מאובטח** ל-Airtable
- **העלאה אוטומטית** של ציורים
- **טיפול בשגיאות** ומתן פתרונות
- **בדיקת חיבור** לפני העלאה

### 🎨 GUI Modules (src/gui/)

#### MainWindow (main_window.py)
- **חלון ראשי מעוצב** עם כל הפונקציות
- **ממשק אינטואיטיבי** לבחירת קבצים
- **הצגת תוצאות** בזמן אמת
- **ניהול אירועים** בחוטים נפרדים

#### DrawingsManagerWindow (drawings_window.py)
- **דף ייעודי** לניהול הטבלה המקומית
- **טבלה מתקדמת** עם אפשרויות מיון וחיפוש
- **צפייה מפורטת** בכל ציור
- **פעולות נוחות** למחיקה ועריכה

### 🔧 Utils Modules (src/utils/)

#### ConfigManager (config_manager.py)
- **ניהול הגדרות** מרכזי
- **שמירה אוטומטית** של העדפות
- **חיפוש אוטומטי** של קובץ מוצרים
- **סטטוס חיבור** לאירטייבל

## הגדרת Airtable

1. **קבלת API Key:**
   - כנס לחשבון האייר טייבל שלך
   - צור Personal Access Token עם הרשאות: `data:read`, `data:write`

2. **מציאת Base ID ו-Table ID:**
   - Base ID: מכתובת הטבלה (`app...`)
   - Table ID: מהגדרות הטבלה (`tbl...`)

3. **הגדרה בתוכנה:**
   - לחץ על "הגדר חיבור" בממשק
   - הזן את הפרטים ושמור

## יתרונות המבנה החדש

### 🎯 ארכיטקטורה נקייה
- **הפרדת דאגות** - כל מודול אחראי על תחום ספציפי
- **קוד ניתן לתחזוקה** - קל למצוא ולתקן בעיות
- **הרחבה פשוטה** - קל להוסיף פונקציות חדשות

### 🔄 גמישות וביצועים
- **טעינה מהירה** - רק המודולים הנדרשים נטענים
- **ניהול זיכרון יעיל** - כל מודול עובד עצמאית
- **טיפול בשגיאות** משופר ומרוכז

### 🧪 קלות בבדיקות
- **כל מודול ניתן לבדיקה** בנפרד
- **ייבוא פשוט** במסגרות בדיקה
- **דמי נתונים** לפיתוח ובדיקה

## טכנולוגיות
- **Python 3.x** - שפת התכנות העיקרית
- **tkinter** - ממשק גרפי מובנה
- **pandas** - עיבוד נתונים מתקדם
- **openpyxl** - טיפול בקובצי Excel
- **pyairtable** - חיבור לאירטייבל
- **JSON** - שמירת הגדרות ונתונים

## פתרון בעיות נפוצות

### בעיות הפעלה
- **"Module not found"**: וודא שהסביבה הוירטואלית פעילה
- **שגיאות ייבוא**: בדוק שכל התלויות מותקנות (`pip install -r requirements.txt`)

### בעיות Airtable
- **403 Forbidden**: בדוק שה-API Key פעיל עם הרשאות מתאימות
- **422 Unprocessable**: העמודות בטבלה חייבות להיות טקסט פשוט
- **Table not found**: וודא שה-Table ID נכון

### בעיות טבלה מקומית
- אם הקובץ `drawings_data.json` נפגם, פשוט מחק אותו - הוא ייווצר מחדש
- גיבוי רגיל של הקובץ מומלץ לשמירת הנתונים

## פיתוח והרחבה

### הוספת מודול חדש
1. צור קובץ במיקום המתאים (core/gui/utils)
2. הוסף ייבוא במודול הראשי
3. עדכן את המבנה בתיעוד

### שינוי העיצוב
- כל רכיבי הממשק נמצאים ב-`src/gui/`
- צבעים ועיצוב מרוכזים בתחילת כל קובץ

## תמיכה והערות
- התוכנה תומכת בעברית ובאנגלית
- טיפול אוטומטי ב-Layout Tubular (חלוקה ב-2)
- מיון חכם של מידות (מספרים, חודשים, טקסט)
- שמירת הגדרות בקובץ JSON

## רישיון
פרויקט בקוד פתוח למטרות לימוד ושימוש מסחרי.

---
**FactorySync v2.0 - ארכיטקטורה מודולרית מקצועית**  
**פותח על ידי לוי**
